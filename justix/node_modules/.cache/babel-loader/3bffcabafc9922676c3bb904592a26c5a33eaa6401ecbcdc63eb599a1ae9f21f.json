{"ast":null,"code":"import React,{useState,useEffect}from'react';import CarouselCustom from'../../components/Carrosel/CarouselCustom';import axios from'axios';import{Star}from'lucide-react';import{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";function HomeCards(){const[tribunais,setTribunais]=useState([]);const[foruns,setForuns]=useState([]);const[juiz,setJuizes]=useState([]);const[mediador,setMediadores]=useState([]);const[advocacia,setAdvocacia]=useState([]);const[portais,setPortais]=useState([]);const sections=[{name:'Tribunais',items:tribunais||[]},{name:'Fóruns',items:foruns||[]},{name:'Audiências',items:juiz||[]},{name:'Mediações',items:mediador||[]},{name:'Advocacia',items:advocacia||[]},{name:'Portais',items:portais||[]}].filter(section=>section.items&&section.items.length>0);const getImageUrl=(type,imagem)=>{if(!imagem)return null;if(imagem.startsWith('/uploads/')){return`http://localhost:3001${imagem}`;}return`http://localhost:3001/uploads/${type}/${imagem}`;};const fetchDataWithWeightedAverage=async(endpoint,setStateFunc,ratingEndpoint,idField)=>{try{const res=await axios.get(`http://localhost:3001/${endpoint}`);const entidadesWithRatings=await Promise.all(res.data.map(async entidade=>{try{const ratingRes=await axios.get(`http://localhost:3001/${ratingEndpoint}/${entidade[idField]}`);const mediaPonderada=parseFloat(ratingRes.data.media_ponderada)||0;return{title:/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{children:entidade.nome}),/*#__PURE__*/_jsx(\"div\",{children:entidade.profissao})]}),subtitle:/*#__PURE__*/_jsxs(_Fragment,{children:[\"M\\xE9dia Ponderada: \",mediaPonderada.toFixed(1),\" \",/*#__PURE__*/_jsx(Star,{size:14,color:\"#4169E1\",fill:\"#4169E1\",style:{verticalAlign:'middle'}})]}),image:getImageUrl(endpoint,entidade.imagem),link:`/user/${endpoint}/${entidade[idField]}/feedback`,id:entidade[idField],media_ponderada:mediaPonderada};}catch(err){console.error(`Erro ao buscar média ponderada:`,err);return{title:entidade.nome,subtitle:'Sem avaliações',image:getImageUrl(endpoint,entidade.imagem),link:`/user/${endpoint}/${entidade[idField]}/feedback`,id:entidade[idField],media_ponderada:0};}}));setStateFunc(entidadesWithRatings);}catch(err){console.error(`Erro ao listar ${endpoint}:`,err);}};useEffect(()=>{fetchDataWithWeightedAverage('tribunais',setTribunais,'tribunais_avaliacao','id_tribunal');fetchDataWithWeightedAverage('foruns',setForuns,'foruns_avaliacao','id_forum');fetchDataWithWeightedAverage('juiz',setJuizes,'juiz_avaliacao','id_juiz');fetchDataWithWeightedAverage('mediador',setMediadores,'mediador_avaliacao','id_mediador');fetchDataWithWeightedAverage('advocacia',setAdvocacia,'advocacia_avaliacao','id_advocacia');fetchDataWithWeightedAverage('portais',setPortais,'portal_avaliacao','id_portal');},[]);return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-12\",children:sections.map((section,index)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CarouselCustom,{name:section.name,carouselItems:section.items,isActive:true}),index<sections.length-1&&/*#__PURE__*/_jsx(\"hr\",{className:\"carousel-divider\"})]},index))})})});}export default HomeCards;","map":{"version":3,"names":["React","useState","useEffect","CarouselCustom","axios","Star","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","HomeCards","tribunais","setTribunais","foruns","setForuns","juiz","setJuizes","mediador","setMediadores","advocacia","setAdvocacia","portais","setPortais","sections","name","items","filter","section","length","getImageUrl","type","imagem","startsWith","fetchDataWithWeightedAverage","endpoint","setStateFunc","ratingEndpoint","idField","res","get","entidadesWithRatings","Promise","all","data","map","entidade","ratingRes","mediaPonderada","parseFloat","media_ponderada","title","children","nome","profissao","subtitle","toFixed","size","color","fill","style","verticalAlign","image","link","id","err","console","error","className","index","carouselItems","isActive"],"sources":["C:/Users/vinic/OneDrive/Área de Trabalho/React project/justix/src/pages/HomeUser/HomeCardsUser.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport CarouselCustom from '../../components/Carrosel/CarouselCustom';\r\nimport axios from 'axios';\r\nimport { Star } from 'lucide-react';\r\n\r\nfunction HomeCards() {\r\n    const [tribunais, setTribunais] = useState([]);\r\n    const [foruns, setForuns] = useState([]);\r\n    const [juiz, setJuizes] = useState([]);\r\n    const [mediador, setMediadores] = useState([]);\r\n    const [advocacia, setAdvocacia] = useState([]);\r\n    const [portais, setPortais] = useState([]);\r\n\r\n    const sections = [\r\n        { name: 'Tribunais', items: tribunais || [] },\r\n        { name: 'Fóruns', items: foruns || [] },\r\n        { name: 'Audiências', items: juiz || [] },\r\n        { name: 'Mediações', items: mediador || [] },\r\n        { name: 'Advocacia', items: advocacia || [] },\r\n        { name: 'Portais', items: portais || [] }\r\n    ].filter(section => section.items && section.items.length > 0);\r\n\r\n    const getImageUrl = (type, imagem) => {\r\n        if (!imagem) return null;\r\n        if (imagem.startsWith('/uploads/')) {\r\n            return `http://localhost:3001${imagem}`;\r\n        }\r\n        return `http://localhost:3001/uploads/${type}/${imagem}`;\r\n    };\r\n\r\n    const fetchDataWithWeightedAverage = async (endpoint, setStateFunc, ratingEndpoint, idField) => {\r\n        try {\r\n            const res = await axios.get(`http://localhost:3001/${endpoint}`);\r\n            const entidadesWithRatings = await Promise.all(\r\n                res.data.map(async (entidade) => {\r\n                    try {\r\n                        const ratingRes = await axios.get(`http://localhost:3001/${ratingEndpoint}/${entidade[idField]}`);\r\n                        const mediaPonderada = parseFloat(ratingRes.data.media_ponderada) || 0;\r\n\r\n                        return {\r\n                            title: (\r\n                                <>\r\n                                    <div>{entidade.nome}</div>\r\n                                    <div>{entidade.profissao}</div>\r\n                                </>\r\n                            ),\r\n                            subtitle: <>Média Ponderada: {mediaPonderada.toFixed(1)} <Star size={14} color=\"#4169E1\" fill=\"#4169E1\" style={{ verticalAlign: 'middle' }} /></>,\r\n                            image: getImageUrl(endpoint, entidade.imagem),\r\n                            link: `/user/${endpoint}/${entidade[idField]}/feedback`,\r\n                            id: entidade[idField],\r\n                            media_ponderada: mediaPonderada\r\n                        };\r\n                    } catch (err) {\r\n                        console.error(`Erro ao buscar média ponderada:`, err);\r\n                        return {\r\n                            title: entidade.nome,\r\n                            subtitle: 'Sem avaliações',\r\n                            image: getImageUrl(endpoint, entidade.imagem),\r\n                            link: `/user/${endpoint}/${entidade[idField]}/feedback`,\r\n                            id: entidade[idField],\r\n                            media_ponderada: 0\r\n                        };\r\n                    }\r\n                })\r\n            );\r\n            setStateFunc(entidadesWithRatings);\r\n        } catch (err) {\r\n            console.error(`Erro ao listar ${endpoint}:`, err);\r\n        }\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchDataWithWeightedAverage('tribunais', setTribunais, 'tribunais_avaliacao', 'id_tribunal');\r\n        fetchDataWithWeightedAverage('foruns', setForuns, 'foruns_avaliacao', 'id_forum');\r\n        fetchDataWithWeightedAverage('juiz', setJuizes, 'juiz_avaliacao', 'id_juiz');\r\n        fetchDataWithWeightedAverage('mediador', setMediadores, 'mediador_avaliacao', 'id_mediador');\r\n        fetchDataWithWeightedAverage('advocacia', setAdvocacia, 'advocacia_avaliacao', 'id_advocacia');\r\n        fetchDataWithWeightedAverage('portais', setPortais, 'portal_avaliacao', 'id_portal');\r\n    }, []);\r\n\r\n    return (\r\n        <div className=\"container-fluid\">\r\n            <div className=\"row\">\r\n                <div className=\"col-12\">\r\n                    {sections.map((section, index) => (\r\n                        <div key={index}>\r\n                            <CarouselCustom \r\n                                name={section.name}\r\n                                carouselItems={section.items}\r\n                                isActive={true}\r\n                            />\r\n                            {index < sections.length - 1 && <hr className=\"carousel-divider\" />}\r\n                        </div>\r\n                    ))}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default HomeCards;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}