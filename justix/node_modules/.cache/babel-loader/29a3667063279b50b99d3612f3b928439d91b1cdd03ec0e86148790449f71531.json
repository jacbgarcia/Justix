{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import{useAuth}from'../../contexts/AuthContext';import{useNavigate,Link}from'react-router-dom';import styles from'./Login.module.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Login(_ref){let{isOpen,onClose}=_ref;const{login}=useAuth();const navigate=useNavigate();const[formData,setFormData]=useState({email:'',senha:''});const[errors,setErrors]=useState({email:'',senha:''});const[error,setError]=useState('');const sidebarRef=useRef(null);useEffect(()=>{const handleClickOutside=event=>{if(sidebarRef.current&&!sidebarRef.current.contains(event.target)){onClose();}};document.addEventListener('mousedown',handleClickOutside);return()=>document.removeEventListener('mousedown',handleClickOutside);},[onClose]);const validateEmail=email=>{if(!email)return'Email é obrigatório';if(!email.includes('@'))return'Email deve conter @';if(!email.includes('.com'))return'Email deve conter .com';return'';};const handleInputChange=e=>{const{id,value}=e.target;setFormData(prev=>({...prev,[id]:value}));setErrors(prev=>({...prev,[id]:''}));};const handleSubmit=async e=>{e.preventDefault();const emailError=validateEmail(formData.email);const senhaError=!formData.senha?'Senha é obrigatória':'';if(emailError||senhaError){setErrors({email:emailError,senha:senhaError});return;}try{const response=await fetch('http://localhost:3001/login',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(formData)});const data=await response.json();if(response.ok){localStorage.setItem('token',data.token);localStorage.setItem('usuarios',JSON.stringify(data.user));login({user:data.user,token:data.token});onClose();switch(data.user.role){case'admin':navigate('/admin/dashboard/tribunais');break;default:navigate('/user/');}}else{setError(data.error);}}catch(error){setError('Erro ao fazer login');}};if(!isOpen)return null;return/*#__PURE__*/_jsx(\"div\",{className:styles.overlay,children:/*#__PURE__*/_jsxs(\"div\",{ref:sidebarRef,className:`${styles.loginContainer} ${isOpen?styles.open:''}`,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.loginHeader,children:[/*#__PURE__*/_jsx(\"h2\",{className:styles.title,children:\"LOGIN\"}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:styles.closeButton,children:\"\\xD7\"})]}),error&&/*#__PURE__*/_jsx(\"span\",{className:styles.errorText,children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,className:styles.loginForm,children:[/*#__PURE__*/_jsxs(\"div\",{className:styles.formGroup,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"email\",children:\"E-mail:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",value:formData.email,onChange:handleInputChange,className:errors.email?styles.inputError:'',required:true}),errors.email&&/*#__PURE__*/_jsx(\"span\",{className:styles.errorText,children:errors.email})]}),/*#__PURE__*/_jsxs(\"div\",{className:styles.formGroup,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"senha\",children:\"Senha:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"senha\",value:formData.senha,onChange:handleInputChange,className:errors.senha?styles.inputError:'',required:true}),errors.senha&&/*#__PURE__*/_jsx(\"span\",{className:styles.errorText,children:errors.senha})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:styles.submitButton,children:\"Entrar\"})]})]})});}export default Login;","map":{"version":3,"names":["React","useState","useEffect","useRef","useAuth","useNavigate","Link","styles","jsx","_jsx","jsxs","_jsxs","Login","_ref","isOpen","onClose","login","navigate","formData","setFormData","email","senha","errors","setErrors","error","setError","sidebarRef","handleClickOutside","event","current","contains","target","document","addEventListener","removeEventListener","validateEmail","includes","handleInputChange","e","id","value","prev","handleSubmit","preventDefault","emailError","senhaError","response","fetch","method","headers","body","JSON","stringify","data","json","ok","localStorage","setItem","token","user","role","className","overlay","children","ref","loginContainer","open","loginHeader","title","onClick","closeButton","errorText","onSubmit","loginForm","formGroup","htmlFor","type","onChange","inputError","required","submitButton"],"sources":["C:/Users/vinic/OneDrive/Área de Trabalho/React project/justix/src/pages/Login/index.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport { useAuth } from '../../contexts/AuthContext';\r\nimport { useNavigate, Link } from 'react-router-dom';\r\nimport styles from './Login.module.css';\r\n\r\nfunction Login({ isOpen, onClose }) {\r\n    const { login } = useAuth();\r\n    const navigate = useNavigate();\r\n    const [formData, setFormData] = useState({ email: '', senha: '' });\r\n    const [errors, setErrors] = useState({ email: '', senha: '' });\r\n    const [error, setError] = useState('');\r\n    const sidebarRef = useRef(null);\r\n\r\n    useEffect(() => {\r\n        const handleClickOutside = (event) => {\r\n            if (sidebarRef.current && !sidebarRef.current.contains(event.target)) {\r\n                onClose();\r\n            }\r\n        };\r\n\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }, [onClose]);\r\n\r\n    const validateEmail = (email) => {\r\n        if (!email) return 'Email é obrigatório';\r\n        if (!email.includes('@')) return 'Email deve conter @';\r\n        if (!email.includes('.com')) return 'Email deve conter .com';\r\n        return '';\r\n    };\r\n\r\n    const handleInputChange = (e) => {\r\n        const { id, value } = e.target;\r\n        setFormData(prev => ({ ...prev, [id]: value }));\r\n        setErrors(prev => ({ ...prev, [id]: '' }));\r\n    };\r\n\r\n    const handleSubmit = async (e) => {\r\n        e.preventDefault();\r\n\r\n        const emailError = validateEmail(formData.email);\r\n        const senhaError = !formData.senha ? 'Senha é obrigatória' : '';\r\n\r\n        if (emailError || senhaError) {\r\n            setErrors({ email: emailError, senha: senhaError });\r\n            return;\r\n        }\r\n\r\n        try {\r\n            const response = await fetch('http://localhost:3001/login', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify(formData)\r\n            });\r\n\r\n            const data = await response.json();\r\n\r\n            if (response.ok) {\r\n                localStorage.setItem('token', data.token);\r\n                localStorage.setItem('usuarios', JSON.stringify(data.user));\r\n                \r\n                login({\r\n                    user: data.user,\r\n                    token: data.token\r\n                });\r\n\r\n                onClose();\r\n                \r\n                switch(data.user.role) {\r\n                    case 'admin':\r\n                        navigate('/admin/dashboard/tribunais');\r\n                        break;\r\n                    default:\r\n                        navigate('/user/');\r\n                }\r\n            } else {\r\n                setError(data.error);\r\n            }\r\n        } catch (error) {\r\n            setError('Erro ao fazer login');\r\n        }\r\n    };\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className={styles.overlay}>\r\n            <div \r\n                ref={sidebarRef}\r\n                className={`${styles.loginContainer} ${isOpen ? styles.open : ''}`}\r\n            >\r\n                <div className={styles.loginHeader}>\r\n                    <h2 className={styles.title}>LOGIN</h2>\r\n                    <button onClick={onClose} className={styles.closeButton}>×</button>\r\n                </div>\r\n\r\n                {error && <span className={styles.errorText}>{error}</span>}\r\n                \r\n                <form onSubmit={handleSubmit} className={styles.loginForm}>\r\n                    <div className={styles.formGroup}>\r\n                        <label htmlFor=\"email\">E-mail:</label>\r\n                        <input\r\n                            type=\"email\"\r\n                            id=\"email\"\r\n                            value={formData.email}\r\n                            onChange={handleInputChange}\r\n                            className={errors.email ? styles.inputError : ''}\r\n                            required\r\n                        />\r\n                        {errors.email && <span className={styles.errorText}>{errors.email}</span>}\r\n                    </div>\r\n\r\n                    <div className={styles.formGroup}>\r\n                        <label htmlFor=\"senha\">Senha:</label>\r\n                        <input\r\n                            type=\"password\"\r\n                            id=\"senha\"\r\n                            value={formData.senha}\r\n                            onChange={handleInputChange}\r\n                            className={errors.senha ? styles.inputError : ''}\r\n                            required\r\n                        />\r\n                        {errors.senha && <span className={styles.errorText}>{errors.senha}</span>}\r\n                    </div>\r\n\r\n                    <button type=\"submit\" className={styles.submitButton}>\r\n                        Entrar\r\n                    </button>\r\n                </form>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Login;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}